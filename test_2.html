<!DOCTYPE html>
<html>
    <head>
        <style>
            .screen{
                display: flex;
            }
            .disign_area{
                display: flex;
                flex-direction: column;
                background: #aaa;
                width: 300px;
                min-height: 900px;
                
            }
            .viewer{
                border: #00b dashed;
                width: 100%;
                min-height: 900px;
            }
            .set_area{
                min-height: 500px;
            }

            .elem_li{
                margin: 5px;
            }
            .new_block{
                display: flex;
                position: relative;
                flex-direction: row;
                min-height: 150px;
                min-width: 660px;
                margin: 5px;
                margin-top: 20px;
                border: #0ab solid;
                justify-content: space-around;
            }
            .delete_btn{
                position: absolute;
                right: 0px;
                top: 0px;
            }
            .set_btn{
                position: absolute;
                right: 45px;
                top: 0px;
            }
            .reset_btn{
                position: absolute;
                right: 213px;
                top: 0px;
            }
            .set_div_btn{
                position: absolute;
                right: 115px;
                top: 0px;
            }

            .elem_area{
                position: relative;
                display: flex;
                border: #ccc dashed;
                min-width: 15%;
            }
            
            .div_elem_set_dialog{
                position: relative;
            }
            .div_elem_set_block{
                position: relative;
                display: flex;
                flex-direction: row;
                justify-content: space-around;
            }
            .div_elem_preview{
                min-width: 500px;
                min-height: 500px;
                display: flex;
                justify-content: space-around;
                align-items: center;
            }
            .div_elem{
                width: 100px;
            }
            .div_elem_set{
                width: 200px;
                min-height: 500px;
                border: #aaa dashed 5px;
                display: flex;
                flex-direction: column;
                margin: 10px;

            }
            .div_elem_sent{
                position: absolute;
                right: 0px;
                bottom: 0px;
            }
            .div_elem_cancel{
                position: absolute;
                right: 45px;
                bottom: 0px;
            }
            .div_elem_block{
                position: relative;
            }
            .div_elem_delete{
                position: absolute;
                right: 0px;
                top:50%;
            }
        </style>
    </head>
    <body>
        <div class="screen">
            <div id="disign_area" class="disign_area">
                <button id="viewer_mod_btn">切換檢視模式</button>
                <button id="set_mod_btn">切換編輯模式</button>
                <button id="create_block_btn" onclick="create_block()">新增區塊</button>
                <ul ondragstart="dragStartHandler(event)" >
                    <li class="elem_li" draggable="true" data-value="text">文字</li>
                    <li class="elem_li" draggable="true" data-value="picture">圖片</li>
                    <li class="elem_li" draggable="true" data-value="list">清單</li>
                    <li class="elem_li" draggable="true" data-value="video">影片</li>
                    <li class="elem_li" draggable="true" data-value="button">按鈕</li>
                    <li class="elem_li" draggable="true" data-value="link">連結</li>
                </ul>
                <div id="reset_elem_selector"></div>
                <div id="set_area" class="set_area">

                    <div id="set_text" style="display: none;">
                        <label for="font_type">文字特效:</label>
                        <select name="font_type" id="font_type">
                            <option value="I">斜體</option>
                            <option value="b">粗體</option>
                            <option value="u">加底線</option>
                            <option value="spu">上標</option>
                            <option value="sbu">下標</option>
                            <option value="strong">強調</option>
                            <option value="s">刪除線</option>
                            <option value="p">無特效</option>
                        </select>
                        <label for="font_family">字型:</label>
                        <select name="font_family" id="font_family">
                            <option value="DFKai-sb">標楷體</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Microsoft JhengHei">微軟正黑體</option>
                            <option value="PMingLiU">新細明體</option>
                            <option value="cursive">手寫體</option>
                        </select>
                        <label for="font_size">字體大小:</label>
                        <input type="number" id="font_size">
                        <label for="font_color">字體顏色:</label>
                        <input type="color" id="font_color">
                        <label for="text_in">輸入文字:</label>
                        <textarea  id="text_in" cols="30" rows="10" style="white-space:pre-line;"></textarea>
                        <button id="text_sent">送出</button>
                        <button id="text_delete">刪除</button>
                        <button id="text_cancel">取消</button>
                    </div>

                    <div id="set_list" style="display: none;">
                        <label for="list_type">清單類型&排序:</label>
                        <div>
                            <select id="list_type">
                                <option value="ul">不可數清單</option>
                                <option value="ol">可數清單</option>
                            </select>
                            <select id="list_style">
                                <option value="row">橫排</option>
                                <option value="column">直排</option>
                            </select>
                            <button id="type_enter_btn">確定</button>
                        </div>
                        <label for="li_margin">條目間距</label>
                        <input type="number" id="li_margin">
                        <label for="new_li_text_in">條目內容</label>
                        <div>
                            <input type="text" id="new_li_text_in">
                            <button id="create_new_li_btn">新增</button>
                        </div>
                        <div id="list_pre_viewer"></div>
                        <button id="new_list_sent">送出</button>
                        <button id="new_list_cancel">取消</button>
                    </div>

                    <div id="reset_list" style="display: none;">
                        <div id="reset_li_previewer"></div>
                        <label for="reset_list_type">更改清單樣式</label>
                        <div>
                            <select id="reset_list_type">
                                <option value="ul">不可數清單</option>
                                <option value="ol">可數清單</option>
                            </select>
                            <select id="reset_list_style">
                                <option value="row">橫排</option>
                                <option value="column">直排</option>
                            </select>
                            <button id="reset_type_enter_btn">確定</button>
                        </div>
                        <label for="reset_li_margin">條目間距</label>
                        <input type="number" id="reset_li_margin">
                        <label for="new_list_text_in">新增條目</label>
                        <div>
                            <input type="text" id="new_list_text_in">
                            <button id="sent_new_li">新增</button>
                        </div>
                        <label for="reset_list_text_in">修改條目</label>
                        <div>
                            <input type="text" id="reset_list_text_in">
                            <button id="sent_reset_li">修改</button>
                            <button id="delete_li">刪除</button>
                        </div>
                        <button id="reset_list_sent">完成編輯</button>
                        <button id="delete_list">刪除清單</button>
                        <button id="reset_list_cancel">取消編輯</button>
                    </div>

                    <div id="set_btn" style="display: none;">
                        <label for="btn_text_in">按鈕文字:</label>
                        <input type="text" id="btn_text_in">
                        <label for="btn_width">按鈕寬度</label>
                        <input type="number" id="btn_width">
                        <button id="new_btn_sent">送出</button>
                        <button id="delete_btn">刪除</button>
                        <button id="new_btn_cancel">取消</button>
                    </div>

                    <div id="set_link" style="display: none;">
                        <label for="link_name">連結提示:</label>
                        <input type="text"  id="link_name">
                        <label for="link_text_in">連結網址:</label>
                        <input type="url"  id="link_text_in">
                        <button id="new_link_sent">送出</button>
                        <button id="delete_link">刪除</button>
                        <button id="new_link_cancel">取消</button>
                    </div>

                    <div id="set_picture" style="display: none;">
                        <label for="picture_onload">圖片上傳</label>
                        <input type="file" id="picture_onload" accept="image/gif, image/jpeg, image/png">
                        <label for="img_size">圖片大小:</label>
                        <input type="number"  id="img_size">
                        <button id="pre_view_btn">預覽</button>
                        <div id="pre_viewer"></div>
                        <button id="new_picture_sent">送出</button>
                        <button id="delete_picture">刪除</button>
                        <button id="new_picture_cancel">取消</button>
                    </div>

                    <div id="set_video" style="display: none;">
                        <label for="video_onload">影片上傳</label>
                        <input type="file" id="video_onload" accept="video/.mp4 video/.ogg, video/.webm">
                        <label for="video_size">影片大小:</label>
                        <input type="number"  id="video_size">
                        <button id="video_pre_view_btn">預覽</button>
                        <div id="video_pre_viewer"></div>
                        <button id="new_video_sent">送出</button>
                        <button id="delete_video">刪除</button>
                        <button id="new_video_cancel">取消</button>
                    </div>

                    <div id="set_div" style="display: none;">
                        <label for="background_color">背景顏色:</label>
                        <input type="color"  id="background_color">
                        <label for="div_width">設定寬度(百分比):</label>
                        <input type="number"  id="div_width">
                        <label for="div_height">設定高度(像素):</label>
                        <input type="number"  id="div_height">
                        <label for="border_style">邊線風格:</label>
                        <select id="border_style">
                            <option value="none">無邊框</option>
                            <option value="dotted">原點</option>
                            <option value="dashed">虛線</option>
                            <option value="solid">實線</option>
                            <option value="double">雙線</option>
                            <option value="groove">雕刻</option>
                            <option value="ridge">浮雕</option>
                            <option value="inset">陷入</option>
                            <option value="outset">突出</option>
                        </select>
                        <label for="border_color">邊線顏色</label>
                        <input type="color"  id="border_color">
                        <label for="border_width">邊線寬</label>
                        <input type="number"  id="border_width">
                        <label for="border_radius">圓角</label>
                        <input type="number" id="border_radius">

                        <label for="block_margin">區塊間距:</label>
                        <input type="number"id="block_margin">
                        <label for="block_flexDirection">內部排序方式:</label>
                        <select id="block_flexDirection">
                            <option value="row">橫向排序</option>
                            <option value="column">直向排序</option>
                        </select>
                        <label for="sort_horizontally">內部水平排序:</label>
                        <select id="sort_horizontally">
                            <option value="flex-start">靠左</option>
                            <option value="flex-end">靠右</option>
                            <option value="center">置中</option>
                        </select>
                        <label for="sort_vertucally">內部垂直排序:</label>
                        <select id="sort_vertucally"> 
                            <option value="flex-start">靠左</option>
                            <option value="flex-end">靠右</option>
                            <option value="center">置中</option>
                        </select>

                        <div id="div_preview"></div>
                        <button id="div_preview_btn">預覽</button>
                        <button id="div_sent">送出</button>
                        <button id="div_cancel">取消</button>
                    </div>
                </div>
            </div>
            <div id="viewer" class="viewer"></div>
        </div>
        <dialog id="div_elem_create_area" class="div_elem_set_dialog" class="div_elem_set_dialog">
            <div class="div_elem_set_block">
                <div id="div_elem" class="div_elem">
                    <ul id="div_elem_select">
                        <li draggable="true" data-value="div_text">文字</li>
                        <li draggable="true" data-value="div_btn">按鈕</li>
                        <li draggable="true" data-value="div_inp">輸入</li>
                        <li draggable="true" data-value="div_img">圖片</li>
                    </ul>
                </div>
                <div id="div_elem_set" class="div_elem_set">
                    <strong>編輯元素:</strong>
                    <div id="div_text_set" style="display: none;">
                        <label for="div_text_textAlign">排版選擇</label>
                        <select id="div_text_textAlign">
                            <option value="left">靠左</option>
                            <option value="right">靠右</option>
                            <option value="center">置中</option>
                        </select>
                        <label for="div_font_type">文字特效:</label>
                        <select id="div_font_type">
                            <option value="I">斜體</option>
                            <option value="b">粗體</option>
                            <option value="u">加底線</option>
                            <option value="spu">上標</option>
                            <option value="sbu">下標</option>
                            <option value="strong">強調</option>
                            <option value="s">刪除線</option>
                            <option value="p">無特效</option>
                        </select>
                        <label for="div_font_family">字型:</label>
                        <select id="div_font_family">
                            <option value="DFKai-sb">標楷體</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Microsoft JhengHei">微軟正黑體</option>
                            <option value="PMingLiU">新細明體</option>
                            <option value="cursive">手寫體</option>
                        </select>
                        <label for="div_font_size">字體大小</label>
                        <input type="number" id="div_font_size">
                        <label for="div_font_color">字體顏色</label>
                        <input type="color" id="div_font_color">
                        <label for="div_text_in">輸入內容</label>
                        <textarea id="div_text_in" cols="30" rows="10"></textarea>
                        <button id="div_text_sent">完成</button>
                        <button id="div_text_cancel">取消</button>
                    </div>
                    <div id="div_btn_set" style="display: none;">
                        <label for="div_btn_text_in">按鈕文字:</label>
                        <input type="text" id="div_btn_text_in">
                        <button id="div_btn_sent">完成</button>
                        <button id="div_btn_cancel">取消</button>
                    </div>
                    <div id="div_inp_set" style="display: none;">
                        <label for="div_input_type">選擇輸入類型:</label>
                        <select  id="div_input_type">
                            <option value="checkbox">checkbox</option>
                            <option value="color">color</option>
                            <option value="date">date</option>
                            <option value="datetime-local">datetime</option>
                            <option value="email">e-mail</option>
                            <option value="file">file</option>
                            <option value="hidden">hidden</option>
                            <option value="image">image</option>
                            <option value="month">month</option>
                            <option value="number">number</option>
                            <option value="password">password</option>
                            <option value="radio">radio</option>
                            <option value="range">range</option>
                            <option value="reset">reset</option>
                            <option value="search">search</option>
                            <option value="tel">tel</option>
                            <option value="text">text</option>
                            <option value="time">time</option>
                            <option value="url">url</option>
                            <option value="week">week</option>
                        </select>
                        <label for="div_inp_label">編輯輸入提示:</label>
                        <input type="text"id="div_inp_label_text_in">
                        <button id="div_inp_sent">完成</button>
                        <button id="div_inp_cancel">取消</button>
                    </div>
                    <div id="div_img_set" style="display: none;">
                        <label for="div_img_onload">圖片上傳</label>
                        <input type="file" id="div_img_onload" accept="image/gif, image/jpeg, image/png">
                        <label for="div_img_size">圖片大小:</label>
                        <input type="number"  id="div_img_size">
                        <button id="div_img_pre_view_btn">預覽</button>
                        <div id="div_img_pre_viewer"></div>
                        <button id="div_img_sent">送出</button>
                        <button id="div_img_cancel">取消</button>
                    </div>
                </div>
                <div id="div_elem_list"></div>
                <div id="div_elem_preview" class="div_elem_preview"></div>
            </div>
            <button id="div_elem_sent" class="div_elem_sent">送出</button>
            <button id="div_elem_cancel" class="div_elem_cancel">取消</button>
            
        </dialog>
        <script>
            let Type = "text";
            let viewer = document.getElementById("viewer");
            let set_area = document.getElementById("set_area");
            let reset_elem_selector = document.getElementById("reset_elem_selector");

            let set_div = document.getElementById("set_div");
            let background_color = document.getElementById("background_color");
            let div_width = document.getElementById("div_width");
            let div_height = document.getElementById("div_height");
            let border_style = document.getElementById("border_style");
            let border_color = document.getElementById("border_color");
            let border_width = document.getElementById("border_width");
            let border_radius = document.getElementById("border_radius");

            let div_preview = document.getElementById("div_preview");
            let div_preview_btn = document.getElementById("div_preview_btn");
            let block_margin = document.getElementById("block_margin");
            let block_flexDirection = document.getElementById("block_flexDirection");
            let sort_horizontally = document.getElementById("sort_horizontally");
            let sort_vertucally = document.getElementById("sort_vertucally");
            let div_sent = document.getElementById("div_sent");
            let div_cancel = document.getElementById("div_cancel");

            let viewer_mod_btn = document.getElementById("viewer_mod_btn");
            let set_mod_btn = document.getElementById("set_mod_btn");
            let create_block_btn = document.getElementById("create_block_btn");
            let block = document.getElementsByClassName("new_block");
            let elem_area = document.getElementsByClassName("elem_area");
            let delete_btn = document.getElementsByClassName("delete_btn");
            let set_btn = document.getElementsByClassName("set_btn");
            let reset_btn = document.getElementsByClassName("reset_btn");
            let set_div_btn = document.getElementsByClassName("set_div_btn");

            set_mod_btn.style.display = "none";
            viewer_mod_btn.onclick = function(){
                set_mod_btn.style.display = "inline";
                create_block_btn.style.display = "none";
                viewer_mod_btn.style.display = "none";
                for (let i = 0; i < block.length; i++) {
                    block[i].style.borderStyle = "none";    
                }
                for (let j = 0; j < delete_btn.length; j++) {
                    delete_btn[j].style.display = "none";    
                }
                for (let k = 0; k < set_btn.length; k++) {
                    set_btn[k].style.display = "none";    
                }
                for (let l = 0; l < reset_btn.length; l++) {
                    reset_btn[l].style.display = "none";    
                }
                for (let m = 0; m < reset_btn.length; m++) {
                    set_div_btn[m].style.display = "none";    
                }
            }

            set_mod_btn.onclick = function(){
                set_mod_btn.style.display = "none";
                create_block_btn.style.display = "inline";
                viewer_mod_btn.style.display = "inline";
                for (let i = 0; i < block.length; i++) {
                    block[i].style.borderStyle = "solid";    
                }
                for (let j = 0; j < delete_btn.length; j++) {
                    delete_btn[j].style.display = "inline";    
                }
                for (let k = 0; k < set_btn.length; k++) {
                    set_btn[k].style.display = "inline";    
                }
                for (let l = 0; l < reset_btn.length; l++) {
                    reset_btn[l].style.display = "inline";    
                }
                for (let m = 0; m < reset_btn.length; m++) {
                    set_div_btn[m].style.display = "inline";    
                }
            }

            function dragStartHandler(event) {
                if (event.target instanceof HTMLLIElement) 
                {
                event.dataTransfer.setData(Type, event.target.dataset.value);
                event.dataTransfer.effectAllowed = 'move'; 
                } 
                else 
                {
                event.preventDefault(); 
                }
            }

            function create_block (){
                let new_block = document.createElement('div');
                let delete_new_block_btn = document.createElement('input');
                new_block.className = "new_block"
                new_block.draggable="true";
                delete_new_block_btn.type = 'button';
                delete_new_block_btn.value = "刪除";
                delete_new_block_btn.className = "delete_btn";
                new_block.appendChild(delete_new_block_btn);
                viewer.appendChild(new_block);

                new_block.ondragover = function (event) {
                    event.dataTransfer.dropEffect = 'move';
                    event.preventDefault();
                }

                new_block.ondrop = function (event){
                    let data = event.dataTransfer.getData(Type);
                    let dropX = event.pageX;
                    let target_block = event.target;
                    switch (data){
                        case "text":{
                            create_text_area(dropX ,target_block);
                        break;}
                        case 'picture':{
                            create_picture_area(dropX ,target_block);
                        break;}
                        case 'list':{
                            create_list_area(dropX ,target_block);
                        break;}
                        case 'video':{
                            create_video_area(dropX ,target_block);
                        break;}
                        case 'button':{
                            create_btn_area(dropX ,target_block);
                        break;}
                        case 'link':{
                            create_link_area(dropX ,target_block);
                        break;}
                        case 'area':{
                            create_div_area(dropX ,target_block);
                        break;}
                    }
                }

                new_block.ondragend = function (){
                    let dropY = event.pageY;
                    for (let b = 0; b < viewer.childNodes.length; b++) {
                        if(dropY < viewer.childNodes[b].offsetTop)
                        {
                            viewer.insertBefore(event.target,viewer.childNodes[b]);
                            break;
                        }
                        if (dropY > viewer.childNodes[b].offsetTop && viewer.childNodes[b] === viewer.lastChild){
                            viewer.appendChild(event.target);
                        }
                    }
                }
                
                delete_new_block_btn.onclick = function (){
                    viewer.removeChild(event.target.parentElement);
                }
            }

            function create_text_area(dropX ,target_block){
                let set_text = document.getElementById("set_text");
                let font_type = document.getElementById("font_type");
                let font_family = document.getElementById("font_family");
                let font_size = document.getElementById("font_size");
                let font_color = document.getElementById("font_color");
                let text_in = document.getElementById("text_in");
                let text_delete = document.getElementById("text_delete");
                let text_sent = document.getElementById("text_sent");
                let text_cancel = document. getElementById("text_cancel");
                let text_area = document.createElement('div');
                let delete_text_area_btn = document.createElement('input');
                let set_text_area_btn = document.createElement('input');
                let reset_text_area_btn = document.createElement('input');
                let set_div_btn = document.createElement('input');
                text_area.className= "elem_area";
                text_area.draggable="true"
                delete_text_area_btn.type = 'button';
                delete_text_area_btn.value = "刪除";
                delete_text_area_btn.classList = "delete_btn";
                set_text_area_btn.type = 'button';
                set_text_area_btn.value = "新增文本";
                set_text_area_btn.classList = "set_btn";
                reset_text_area_btn.type = 'button';
                reset_text_area_btn.value = "編輯文本";
                reset_text_area_btn.classList = "reset_btn";
                set_div_btn.type = 'button';
                set_div_btn.value = "編輯文本區塊";
                set_div_btn.classList = "set_div_btn";
                text_area.appendChild(reset_text_area_btn);
                text_area.appendChild(set_div_btn);
                text_area.appendChild(delete_text_area_btn);
                text_area.appendChild(set_text_area_btn);
                
                reset_text_area_btn.style.display = "none";

                set_div_btn.onclick = function (){
                    let div = event.target.parentElement;
                    let new_div = div.cloneNode();
                    set_div.style.display = "flex";
                    set_div.style.flexDirection = "column";
                    div_preview.appendChild(new_div)
                    div_preview_btn.onclick = function (){
                        new_div.style.width = 250 + 'px';
                        new_div.style.backgroundColor = background_color.value;
                        new_div.style.height = 250 + 'px';
                        new_div.style.borderColor = border_color.value;
                        new_div.style.borderStyle = border_style.value;
                        new_div.style.borderWidth = border_width.value + 'px';
                        new_div.style.borderRadius = border_radius.value +  'px';   
                    }

                    div_sent.onclick = function (){
                        div.style.width = div_width.value + '%';
                        div.style.backgroundColor = background_color.value;
                        div.style.minHeight = div_height.value + 'px';
                        div.style.borderColor = border_color.value;
                        div.style.borderStyle = border_style.value;
                        div.style.borderWidth = border_width.value + 'px';
                        div.style.borderRadius = border_radius.value + 'px';

                        div.style.flexDirection = block_flexDirection.value;
                        if (block_flexDirection.value == "row") {
                            div.style.alignContent = sort_vertucally.value;
                            div.style.justifyContent = sort_horizontally.value;
                        }
                        else if (block_flexDirection.value == "column"){
                            div.style.alignItems = sort_horizontally.value;
                            div.style.justifyContent = sort_vertucally.value;
                        }
                        div.style.margin = block_margin.value + 'px';

                        set_div.style.display = "none";
                        div_preview.removeChild(div_preview.firstChild);
                    }
                }


                for (let i = 0; i < target_block.childNodes.length; i++) {
                    if (target_block.childNodes.length == 1){
                        target_block.appendChild(text_area);
                        break;
                    }
                    if (dropX < target_block.childNodes[i].offsetLeft){
                        target_block.insertBefore(text_area,target_block.childNodes[i]);
                        break;
                    }
                    if (dropX > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                        target_block.appendChild(text_area);
                        break;
                    }
                }

                text_area.ondragend = function (){
                    let x = event.pageX
                    console.log(target_block); 
                    for (let i = 0; i < target_block.childNodes.length; i++) {
                        if (x < target_block.childNodes[i].offsetLeft){
                            target_block.insertBefore(event.target,target_block.childNodes[i]);
                            break;
                        }
                        if (x > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                            target_block.appendChild(event.target);
                            break;
                        }
                    }
                    event.stopPropagation()
                }

                delete_text_area_btn.onclick = function (){
                    target_block.removeChild(event.target.parentElement);
                    if (text_area.childNodes.length == 3){
                        reset_text_area_btn.style.display = "none";
                    }
                }

                set_text_area_btn.onclick = function (){
                    let set_text_area = event.target.parentElement;
                    set_text.style.display = "flex";
                    set_text.style.flexDirection = "column";
                    text_delete.style.display = "none";
                    text_sent.onclick = function (){
                        let text = document.createElement(font_type.value);
                        text.style.wordWrap = "break-word";
                        text.style.fontFamily = font_family.value;
                        text.style.color = font_color.value;
                        text.style.fontSize = font_size.value + 'px';
                        text.textContent = text_in.value;
                        set_text_area.appendChild(text);
                        set_text_area.firstChild.style.display = "inline"
                        set_text.style.display = "none";
                    }

                    text_cancel.onclick = function (){
                        set_text.style.display = "none";
                    }
                };

                reset_text_area_btn.onclick = function (){
                    let reset_text_area = event.target.parentElement;
                    let reset_text_ul = document.createElement('ul');
                    reset_text_ul.style.listStyle = "none";
                    if(reset_elem_selector.childNodes.length !== 0){
                        reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                    }
                    for (let i = 3; i < reset_text_area.childNodes.length; i++) {
                      let reset_text_li = document.createElement('li');
                      reset_text_li.id = i ;
                      reset_text_li.textContent = "編輯第" + (i-2) + "個文本"; 
                      reset_text_ul.appendChild(reset_text_li);
                      reset_elem_selector.appendChild(reset_text_ul);

                      reset_text_li.onclick = function (){
                        let reset_li = event.target;
                        let reset_text = reset_text_area.childNodes[event.target.id];
                        set_text.style.display = "flex";
                        set_text.style.flexDirection = "column";
                        text_delete.style.display = "inline";
                        font_type.value = reset_text.tagName;
                        font_family.value = reset_text.style.fontFamily;
                        font_color.value = reset_text.style.color;
                        font_size.value = reset_text.style.fontSize.substr(1, 2);
                        text_in.value = reset_text.textContent;
                        text_sent.onclick = function (){
                            let new_text = document.createElement(font_type.value);
                            new_text.style.fontFamily = font_family.value;
                            new_text.style.color = font_color.value;
                            new_text.style.fontSize = font_size.value + 'px';
                            new_text.textContent = text_in.value;
                            reset_text_area.replaceChild(new_text,reset_text);
                            set_text.style.display = "none";
                            if(reset_elem_selector.childNodes.length !== 0){
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                            }
                        }

                        text_delete.onclick = function (){
                            reset_text_area.removeChild(reset_text);
                            set_text.style.display = "none";
                            reset_text_ul.removeChild(reset_li);
                            if (reset_text_area.childNodes.length == 3){
                                reset_text_area.firstChild.style.display = "none";
                            }
                            reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                        }

                        text_cancel.onclick = function (){
                            reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                            set_text.style.display = "none";
                        }
                      }
                    }
                    
                }
            }
            
            function create_list_area(dropX ,target_block){
                let set_list = document.getElementById('set_list');
                let list_type = document.getElementById ("list_type");
                let li_margin = document.getElementById("li_margin");
                let new_li_text_in = document.getElementById ("new_li_text_in");
                let create_new_li_btn = document.getElementById ("create_new_li_btn");
                let list_pre_viewer = document.getElementById ("list_pre_viewer");
                let list_delete = document.getElementById("list_delete");
                let new_list_sent = document.getElementById ("new_list_sent");
                let new_list_cancel = document.getElementById("new_list_cancel");
                let type_enter_btn = document.getElementById ("type_enter_btn");
                let list_style = document.getElementById("list_style");
                let reset_list = document.getElementById("reset_list");
                let reset_li_previewer = document.getElementById("reset_li_previewer");
                let reset_list_type = document.getElementById("reset_list_type");
                let reset_list_style = document.getElementById("reset_list_style");
                let reset_type_enter_btn = document.getElementById("reset_type_enter_btn");
                let new_list_text_in = document.getElementById("new_list_text_in");
                let sent_new_li = document.getElementById("sent_new_li");
                let reset_li_margin = document.getElementById("reset_li_margin");
                let reset_list_text_in = document.getElementById("reset_list_text_in");
                let sent_reset_li = document.getElementById("sent_reset_li");
                let delete_li = document.getElementById("delete_li");
                let reset_list_sent = document.getElementById("reset_list_sent");
                let reset_list_cancel = document.getElementById("reset_list_cancel");
                let delete_list = document.getElementById("delete_list");
                let list_area = document.createElement('div');
                let delete_list_area_btn = document.createElement('input');
                let set_list_area_btn = document.createElement('input');
                let reset_list_area_btn = document.createElement('input');
                let set_div_btn = document.createElement('input');
                list_area.className= "elem_area";
                list_area.draggable="true"
                delete_list_area_btn.type = 'button';
                delete_list_area_btn.value = "刪除";
                delete_list_area_btn.classList = "delete_btn";
                set_list_area_btn.type = 'button';
                set_list_area_btn.value = "新增清單";
                set_list_area_btn.classList = "set_btn";
                reset_list_area_btn.type = 'button';
                reset_list_area_btn.value = "編輯清單";
                reset_list_area_btn.classList = "reset_btn";
                set_div_btn.type = 'button';
                set_div_btn.value = "編輯清單區塊";
                set_div_btn.classList = "set_div_btn";
                list_area.appendChild(reset_list_area_btn);
                list_area.appendChild(set_div_btn);
                list_area.appendChild(delete_list_area_btn);
                list_area.appendChild(set_list_area_btn);

                reset_list_area_btn.style.display = "none";

                set_div_btn.onclick = function (){
                    let div = event.target.parentElement;
                    let new_div = div.cloneNode();
                    set_div.style.display = "flex";
                    set_div.style.flexDirection = "column";
                    div_preview.appendChild(new_div)
                    div_preview_btn.onclick = function (){
                        new_div.style.width = 250 + 'px';
                        new_div.style.backgroundColor = background_color.value;
                        new_div.style.height = 250 + 'px';
                        new_div.style.borderColor = border_color.value;
                        new_div.style.borderStyle = border_style.value;
                        new_div.style.borderWidth = border_width.value + 'px';
                        new_div.style.borderRadius = border_radius.value +  'px';    
                    }

                    div_sent.onclick = function (){
                        div.style.width = div_width.value + '%';
                        div.style.backgroundColor = background_color.value;
                        div.style.minHeight = div_height.value + 'px';
                        div.style.borderColor = border_color.value;
                        div.style.borderStyle = border_style.value;
                        div.style.borderWidth = border_width.value + 'px';
                        div.style.borderRadius = border_radius.value + 'px';

                        div.style.flexDirection = block_flexDirection.value;
                        if (block_flexDirection.value == "row") {
                            div.style.alignContent = sort_vertucally.value;
                            div.style.justifyContent = sort_horizontally.value;
                        }
                        else if (block_flexDirection.value == "column"){
                            div.style.alignItems = sort_horizontally.value;
                            div.style.justifyContent = sort_vertucally.value;
                        }
                        div.style.margin = block_margin.value + 'px';

                        set_div.style.display = "none";
                        div_preview.removeChild(div_preview.firstChild);
                    }
                }

                for (let i = 0; i < target_block.childNodes.length; i++) {
                    if (target_block.childNodes.length == 1){
                        target_block.appendChild(list_area);
                        break;
                    }
                    if (dropX < target_block.childNodes[i].offsetLeft){
                        target_block.insertBefore(list_area,target_block.childNodes[i]);
                        break;
                    }
                    if (dropX > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                        target_block.appendChild(list_area);
                        break;
                    }
                }

                list_area.ondragend = function (){
                    let x = event.pageX
                    for (let i = 0; i < target_block.childNodes.length; i++) {
                        if (x < target_block.childNodes[i].offsetLeft){
                            target_block.insertBefore(event.target,target_block.childNodes[i]);
                            break;
                        }
                        if (x > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                            target_block.appendChild(event.target);
                            break;
                        }
                    }
                    event.stopPropagation()
                }

                delete_list_area_btn.onclick = function (){
                    target_block.removeChild(event.target.parentElement);
                } 

                set_list_area_btn.onclick = function (){
                    let set_list_area = event.target.parentElement;
                    set_list.style.display = "flex";
                    set_list.style.flexDirection = "column";

                    type_enter_btn.onclick = function (){ 
                        let new_list = document.createElement(list_type.value);    
                        
                        list_pre_viewer.appendChild(new_list);
                    }

                    create_new_li_btn.onclick = function (){
                        let new_li = document.createElement('li');
                        new_li.textContent = new_li_text_in.value;
                        list_pre_viewer.lastElementChild.appendChild(new_li);
                    }

                    new_list_sent.onclick = function (){
                        list_pre_viewer.lastElementChild.style.display = "flex";
                        list_pre_viewer.lastElementChild.style.flexDirection = list_style.value;
                        for (let i = 0; i < list_pre_viewer.lastElementChild.childNodes.length; i++) {
                            list_pre_viewer.lastElementChild.childNodes[i].style.margin = li_margin.value + 'px';
                        }
                        set_list.style.display = "none";
                        set_list_area.appendChild(list_pre_viewer.lastElementChild);
                        if(set_list_area.childNodes.length !== 3){
                            set_list_area.firstChild.style.display = "inline";
                        }
                    }

                    new_list_cancel.onclick = function (){
                        set_list.style.display = "none";
                        if (list_pre_viewer.childNodes.length !== 0){
                            list_pre_viewer.removeChild(list_pre_viewer.firstChild);
                        }
                    }
                }

                reset_list_area_btn.onclick = function (){
                    let reset_list_area = event.target.parentElement;
                    let reset_list_ul = document.createElement('ul');
                    if(reset_elem_selector.childNodes.length !== 0){
                        reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                    }
                    for (let i = 3; i < reset_list_area.childNodes.length; i++) {
                        let reset_list_li = document.createElement('li');
                        reset_list_li.id = i;
                        reset_list_li.textContent = "編輯第"+ (i-2) + "個清單";
                        reset_list_ul.appendChild(reset_list_li);
                        reset_elem_selector.appendChild(reset_list_ul);

                        reset_list_li.onclick = function (){
                            reset_list.style.display = "flex";
                            reset_list.style.flexDirection = "column";
                            let pre_reset_ul = reset_list_area.childNodes[event.target.id];
                            let reset_ul = pre_reset_ul.cloneNode(true);
                            reset_ul.style.flexDirection = "column";
                            for (let i = 0; i < reset_ul.childNodes.length; i++) {
                                reset_ul.childNodes[i].style.margin = 0 + 'px';
                                reset_ul.childNodes[i].onclick = function (){
                                    let reset_li = event.target;
                                    reset_list_text_in.value = reset_li.textContent;
                                    sent_reset_li.onclick = function (){
                                        reset_li.textContent = reset_list_text_in.value
                                    }
                                    delete_li.onclick = function (){
                                        reset_ul.removeChild(reset_li);
                                    }
                                }
                            }
                            reset_li_previewer.appendChild(reset_ul);
                            sent_new_li.onclick = function (){
                                let new_li = document.createElement('li');
                                new_li.textContent = new_list_text_in.value
                                reset_ul.appendChild(new_li);
                            }

                            reset_list_sent.onclick = function (){
                                reset_ul.style.flexDirection = list_style.value;
                                for (let i = 0; i < reset_ul.childNodes.length; i++) {
                                    reset_ul.childNodes[i].style.margin = reset_li_margin +'px';    
                                }
                                reset_list_area.replaceChild(reset_ul,pre_reset_ul);
                                if(reset_elem_selector.childNodes.length !== 0){
                                    reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                                }
                                reset_list.style.display = "none";
                            }

                            delete_list.onclick = function (){
                                reset_list_area.removeChild(pre_reset_ul);
                                if(reset_elem_selector.childNodes.length !== 0){
                                    reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                                }
                                reset_list.style.display = "none";
                                if(reset_list_area.childNodes.length == 3){
                                    reset_list_area.firstChild.style.display = "none";
                                }
                            }

                            reset_list_cancel.onclick = function (){
                                reset_li_previewer.removeChild(reset_ul);
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);
                                reset_list.style.display = "none";
                            }
                        }
                    }
                }
            }

            function create_btn_area(dropX ,target_block){
                let set_btn = document.getElementById('set_btn');
                let btn_area = document.createElement('div');
                let delete_btn_area_btn = document.createElement('input');
                let set_btn_area_btn = document.createElement('input');
                let reset_btn_area_btn = document.createElement('input');
                let new_btn_sent = document.getElementById("new_btn_sent");
                let new_btn_cancel = document.getElementById("new_btn_cancel");
                let delete_btn = document.getElementById("delete_btn");
                let btn_text_in = document.getElementById("btn_text_in");
                let btn_width = document.getElementById("btn_width");
                let set_div_btn = document.createElement('input');
                btn_area.className= "elem_area";
                btn_area.draggable="true"
                delete_btn_area_btn.type = 'button';
                delete_btn_area_btn.value = "刪除";
                delete_btn_area_btn.classList = "delete_btn";
                set_btn_area_btn.type = 'button';
                set_btn_area_btn.value = "按鈕新增";
                set_btn_area_btn.classList = "set_btn";
                reset_btn_area_btn.type = 'button';
                reset_btn_area_btn.value = "編輯按鈕";
                reset_btn_area_btn.classList = "reset_btn";
                set_div_btn.type = 'button';
                set_div_btn.value = "編輯按鈕區塊";
                set_div_btn.classList = "set_div_btn";
                btn_area.appendChild(reset_btn_area_btn);
                btn_area.appendChild(delete_btn_area_btn);
                btn_area.appendChild(set_btn_area_btn);
                btn_area.appendChild(set_div_btn);

                reset_btn_area_btn.style.display = "none"

                set_div_btn.onclick = function (){
                    let div = event.target.parentElement;
                    let new_div = div.cloneNode();
                    set_div.style.display = "flex";
                    set_div.style.flexDirection = "column";
                    div_preview.appendChild(new_div)
                    div_preview_btn.onclick = function (){
                        new_div.style.width = 250 + 'px';
                        new_div.style.backgroundColor = background_color.value;
                        new_div.style.height = 250 + 'px';
                        new_div.style.borderColor = border_color.value;
                        new_div.style.borderStyle = border_style.value;
                        new_div.style.borderWidth = border_width.value + 'px';
                        new_div.style.borderRadius = border_radius.value +  'px';   
                    }

                    div_sent.onclick = function (){
                        div.style.width = div_width.value + '%';
                        div.style.backgroundColor = background_color.value;
                        div.style.minHeight = div_height.value + 'px';
                        div.style.borderColor = border_color.value;
                        div.style.borderStyle = border_style.value;
                        div.style.borderWidth = border_width.value + 'px';
                        div.style.borderRadius = border_radius.value + 'px';

                        div.style.flexDirection = block_flexDirection.value;
                        if (block_flexDirection.value == "row") {
                            div.style.alignContent = sort_vertucally.value;
                            div.style.justifyContent = sort_horizontally.value;
                        }
                        else if (block_flexDirection.value == "column"){
                            div.style.alignItems = sort_horizontally.value;
                            div.style.justifyContent = sort_vertucally.value;
                        }
                        div.style.margin = block_margin.value + 'px';

                        set_div.style.display = "none";
                        div_preview.removeChild(div_preview.firstChild);
                    }
                }

                for (let i = 0; i < target_block.childNodes.length; i++) {
                    if (target_block.childNodes.length == 1){
                        target_block.appendChild(btn_area);
                        break;
                    }
                    if (dropX < target_block.childNodes[i].offsetLeft){
                        target_block.insertBefore(btn_area,target_block.childNodes[i]);
                        break;
                    }
                    if (dropX > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                        target_block.appendChild(btn_area);
                        break;
                    }
                }

                btn_area.ondragend = function (){
                    let x = event.pageX
                    for (let i = 0; i < target_block.childNodes.length; i++) {
                        if (x < target_block.childNodes[i].offsetLeft){
                            target_block.insertBefore(event.target,target_block.childNodes[i]);
                            break;
                        }
                        if (x > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                            target_block.appendChild(event.target);
                            break;
                        }
                    }
                    event.stopPropagation()
                }

                delete_btn_area_btn.onclick = function (){
                    target_block.removeChild(event.target.parentElement);
                }

                set_btn_area_btn.onclick = function (){
                    let set_btn_area = event.target.parentElement;
                    set_btn.style.display = "flex";
                    set_btn.style.flexDirection = "column";
                    delete_btn.style.display = "none";
                    new_btn_sent.onclick = function (){
                        let new_btn = document.createElement('button');
                        new_btn.textContent = btn_text_in.value;
                        new_btn.style.width = btn_width.value + 'px';
                        set_btn_area.appendChild(new_btn)
                        set_btn.style.display = "none";
                        if (set_btn_area.childNodes.length !== 3){
                            set_btn_area.firstChild.style.display = "inline";
                        }
                    }
                    new_btn_cancel.onclick = function (){
                        set_btn.style.display = "none";
                    }
                }

                reset_btn_area_btn.onclick = function (){
                    let reset_btn_area = event.target.parentElement
                    let reset_btn_ul = document.createElement('ul');
                    if(reset_elem_selector.childNodes.length !== 0){
                        reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                    }
                    for (let i = 3; i < reset_btn_area.childNodes.length; i++) {
                        let reset_btn_li = document.createElement('li');
                        reset_btn_li.id = i ;
                        reset_btn_li.textContent = "編輯第"+ (i-2) + "個按鈕";
                        reset_btn_ul.appendChild(reset_btn_li);
                        reset_elem_selector.appendChild(reset_btn_ul);

                        reset_btn_li.onclick = function (){
                            let reset_btn = reset_btn_area.childNodes[event.target.id];
                            set_btn.style.display = "flex";
                            set_btn.style.flexDirection = "column";
                            delete_btn.style.display = "inline";
                            btn_text_in.value = reset_btn.textContent ;
                            new_btn_sent.onclick = function (){
                                reset_btn.textContent = btn_text_in.value;
                                reset_btn.style.width = btn_width.value + 'px';
                                reset_elem_selector.removeChild(reset_elem_selector.firstElementChild);
                                set_btn.style.display = "none";
                            }

                            delete_btn.onclick = function (){
                                reset_btn_area.removeChild(reset_btn);
                                reset_elem_selector.removeChild(reset_elem_selector.firstElementChild);
                                if (reset_btn_area.childNodes.length == 3){
                                    reset_btn_area.firstChild.style.display = "none";
                                }
                                set_btn.style.display = "none";
                            }
                            new_btn_cancel.onclick = function (){
                                reset_elem_selector.removeChild(reset_elem_selector.firstElementChild);
                                set_btn.style.display = "none";
                            }

                        }
                    }
                }
            }

            function create_link_area(dropX ,target_block){
                let set_link = document.getElementById('set_link');
                let new_link_sent = document.getElementById("new_link_sent");
                let new_link_cancel = document.getElementById("new_link_cancel");
                let link_name = document.getElementById("link_name");
                let link_text_in = document.getElementById("link_text_in");
                let link_align_items = document.getElementById("link_align_items");
                let delete_link = document.getElementById("delete_link");
                let link_area = document.createElement('div');
                let delete_link_area_btn = document.createElement('input');
                let set_link_area_btn = document.createElement('input');
                let reset_link_area_btn = document.createElement('input');
                let set_div_btn = document.createElement('input');
                link_area.className= "elem_area";
                link_area.draggable="true"
                delete_link_area_btn.type = 'button';
                delete_link_area_btn.value = "刪除";
                delete_link_area_btn.classList = "delete_btn";
                set_link_area_btn.type = 'button';
                set_link_area_btn.value = "連結新增";
                set_link_area_btn.classList = "set_btn";
                reset_link_area_btn.type = 'button';
                reset_link_area_btn.value = "編輯連結";
                reset_link_area_btn.classList = "reset_btn";
                set_div_btn.type = 'button';
                set_div_btn.value = "編輯連結區塊";
                set_div_btn.classList = "set_div_btn";
                link_area.appendChild(reset_link_area_btn);
                link_area.appendChild(delete_link_area_btn);
                link_area.appendChild(set_link_area_btn);
                link_area.appendChild(set_div_btn);

                reset_link_area_btn.style.display = "none";
                set_div_btn.onclick = function (){
                    let div = event.target.parentElement;
                    let new_div = div.cloneNode();
                    set_div.style.display = "flex";
                    set_div.style.flexDirection = "column";
                    div_preview.appendChild(new_div)
                    div_preview_btn.onclick = function (){
                        new_div.style.width = 250 + 'px';
                        new_div.style.backgroundColor = background_color.value;
                        new_div.style.height = 250 + 'px';
                        new_div.style.borderColor = border_color.value;
                        new_div.style.borderStyle = border_style.value;
                        new_div.style.borderWidth = border_width.value + 'px';
                        new_div.style.borderRadius = border_radius.value +  'px';   
                    }

                    div_sent.onclick = function (){
                        div.style.width = div_width.value + '%';
                        div.style.backgroundColor = background_color.value;
                        div.style.minHeight = div_height.value + 'px';
                        div.style.borderColor = border_color.value;
                        div.style.borderStyle = border_style.value;
                        div.style.borderWidth = border_width.value + 'px';
                        div.style.borderRadius = border_radius.value + 'px';

                        div.style.flexDirection = block_flexDirection.value;
                        if (block_flexDirection.value == "row") {
                            div.style.alignContent = sort_vertucally.value;
                            div.style.justifyContent = sort_horizontally.value;
                        }
                        else if (block_flexDirection.value == "column"){
                            div.style.alignItems = sort_horizontally.value;
                            div.style.justifyContent = sort_vertucally.value;
                        }
                        div.style.margin = block_margin.value + 'px';

                        set_div.style.display = "none";
                        div_preview.removeChild(div_preview.firstChild);
                    }
                }
                for (let i = 0; i < target_block.childNodes.length; i++) {
                    if (target_block.childNodes.length == 1){
                        target_block.appendChild(link_area);
                        break;
                    }
                    if (dropX < target_block.childNodes[i].offsetLeft){
                        target_block.insertBefore(link_area,target_block.childNodes[i]);
                        break;
                    }
                    if (dropX > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                        target_block.appendChild(link_area);
                        break;
                    }
                }

                link_area.ondragend = function (){
                    let x = event.pageX
                    for (let i = 0; i < target_block.childNodes.length; i++) {
                        if (x < target_block.childNodes[i].offsetLeft){
                            target_block.insertBefore(event.target,target_block.childNodes[i]);
                            break;
                        }
                        if (x > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                            target_block.appendChild(event.target);
                            break;
                        }
                    }
                    event.stopPropagation()
                }

                delete_link_area_btn.onclick = function (){
                    target_block.removeChild(event.target.parentElement);
                }

                set_link_area_btn.onclick = function (){
                    let set_link_area = event.target.parentElement;
                    set_link.style.display = "flex";
                    set_link.style.flexDirection = "column";
                    delete_link.style.display = "none";
                    new_link_sent.onclick = function (){
                        let new_link = document.createElement('a');
                        new_link.textContent = link_name.value;
                        new_link.href = link_text_in.value;
                        set_link.style.display = "none";
                        set_link_area.appendChild(new_link);
                        if (set_link_area.childNodes.length !== 3){
                            set_link_area.firstChild.style.display = "inline"
                        }
                    }

                    new_link_cancel.onclick = function (){
                        set_link.style.display = "none"; 
                    }
                }

                reset_link_area_btn.onclick = function (){
                    let reset_link_area = event.target.parentElement;
                    let reset_link_ul = document.createElement('ul');
                    if(reset_elem_selector.childNodes.length !== 0){
                        reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                    }
                    for (let i = 3; i < reset_link_area.childNodes.length; i++){
                        let reset_link_li = document.createElement('li')
                        reset_link_li.id = i;
                        reset_link_li.textContent = "編輯第" + (i-2) + "個連結";
                        reset_link_ul.appendChild(reset_link_li);
                        reset_elem_selector.appendChild(reset_link_ul);

                        reset_link_li.onclick = function (){
                            let reset_link = reset_link_area.childNodes[event.target.id];
                            set_link.style.display = "flex";
                            set_link.style.flexDirection = "column";
                            delete_link.style.display = "inline";
                            link_name.value = reset_link.textContent;
                            link_text_in.value = reset_link.href;
                            new_link_sent.onclick = function (){
                                reset_link.textContent = link_name.value;
                                reset_link.href = link_text_in.value;
                                set_link.style.display = "none";
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);
                            }
                            delete_link.onclick = function (){
                                reset_link_area.removeChild(reset_link);
                                set_link.style.display = "none";
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);
                                if(reset_link_area.childNodes.length == 3){
                                    reset_link_area.firstElementChild.style.display = "none";
                                }
                            }
                            new_link_cancel.onclick = function (){
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);
                                set_link.style.display = "none"; 
                            }
                        }


                    }
                }
            }
        
            function create_picture_area(dropX ,target_block){
                let set_picture = document.getElementById('set_picture');
                let new_picture_sent = document.getElementById("new_picture_sent");
                let new_picture_cancel = document.getElementById("new_picture_cancel");
                let picture_onload = document.getElementById("picture_onload");
                let img_size = document.getElementById("img_size");
                let pre_view_btn = document.getElementById("pre_view_btn");
                let pre_viewer = document.getElementById("pre_viewer");
                let picture_area = document.createElement('div');
                let delete_picture = document.getElementById("delete_picture");
                let delete_picture_area_btn = document.createElement('input');
                let set_picture_area_btn = document.createElement('input');
                let reset_picture_area_btn = document.createElement('input');
                let set_div_btn = document.createElement('input');
                picture_area.className= "elem_area";
                picture_area.draggable="true"
                delete_picture_area_btn.type = 'button';
                delete_picture_area_btn.value = "刪除";
                delete_picture_area_btn.classList = "delete_btn";
                set_picture_area_btn.type = 'button';
                set_picture_area_btn.value = "圖片新增";
                set_picture_area_btn.classList = "set_btn";
                reset_picture_area_btn.type = 'button';
                reset_picture_area_btn.value = "編輯圖片";
                reset_picture_area_btn.classList = "reset_btn";
                set_div_btn.type = 'button';
                set_div_btn.value = "編輯圖片區塊";
                set_div_btn.classList = "set_div_btn";
                picture_area.appendChild(reset_picture_area_btn);
                picture_area.appendChild(delete_picture_area_btn);
                picture_area.appendChild(set_picture_area_btn);
                picture_area.appendChild(set_div_btn);

                reset_picture_area_btn.style.display = "none"

                set_div_btn.onclick = function (){
                    let div = event.target.parentElement;
                    let new_div = div.cloneNode();
                    set_div.style.display = "flex";
                    set_div.style.flexDirection = "column";
                    div_preview.appendChild(new_div);
                    div_preview_btn.onclick = function (){
                        new_div.style.width = 250 + 'px';
                        new_div.style.backgroundColor = background_color.value;
                        new_div.style.height = 250 + 'px';
                        new_div.style.borderColor = border_color.value;
                        new_div.style.borderStyle = border_style.value;
                        new_div.style.borderWidth = border_width.value + 'px';
                        new_div.style.borderRadius = border_radius.value +  'px';
                    }

                    div_sent.onclick = function (){
                        div.style.minWidth = div_width.value + '%';
                        div.style.backgroundColor = background_color.value;
                        div.style.minHeight = div_height.value + 'px';
                        div.style.borderColor = border_color.value;
                        div.style.borderStyle = border_style.value;
                        div.style.borderWidth = border_width.value + 'px';
                        div.style.borderRadius = border_radius.value + 'px';

                        div.style.flexDirection = block_flexDirection.value;
                        if (block_flexDirection.value == "row") {
                            div.style.alignContent = sort_vertucally.value;
                            div.style.justifyContent = sort_horizontally.value;
                        }
                        else if (block_flexDirection.value == "column"){
                            div.style.alignItems = sort_horizontally.value;
                            div.style.justifyContent = sort_vertucally.value;
                        }
                        div.style.margin = block_margin.value + 'px';

                        set_div.style.display = "none";
                        div_preview.removeChild(div_preview.firstChild);
                    }
                }

                for (let i = 0; i < target_block.childNodes.length; i++) {
                    if (target_block.childNodes.length == 1){
                        target_block.appendChild(picture_area);
                        break;
                    }
                    if (dropX < target_block.childNodes[i].offsetLeft){
                        target_block.insertBefore(picture_area,target_block.childNodes[i]);
                        break;
                    }
                    if (dropX > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                        target_block.appendChild(picture_area);
                        break;
                    }
                }

                picture_area.ondragend = function (){
                    let x = event.pageX
                    for (let i = 0; i < target_block.childNodes.length; i++) {
                        if (x < target_block.childNodes[i].offsetLeft){
                            target_block.insertBefore(event.target,target_block.childNodes[i]);
                            break;
                        }
                        if (x > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                            target_block.appendChild(event.target);
                            break;
                        }
                    }
                    event.stopPropagation()
                }

                delete_picture_area_btn.onclick = function (){
                    target_block.removeChild(event.target.parentElement);
                }

                set_picture_area_btn.onclick = function (){
                    let set_picture_area = event.target.parentElement;
                    let set_img_btn = event.target;
                    set_picture.style.display = "flex";
                    set_picture.style.flexDirection = "column";
                    delete_picture.style.display = "none";
                    picture_onload.onchange = function(){
                        let reader = new FileReader();
                        let img = document.createElement('img');

                        reader.onload = function (e){                               
                            img.setAttribute("src", e.target.result)
                        }
                        reader.readAsDataURL(this.files[0]);

                        pre_view_btn.onclick = function (){
                            img.style.width = 300 + 'px';
                            pre_viewer.appendChild(img)
                        }
                    }
                    
                    new_picture_sent.onclick = function (){
                        pre_viewer.firstChild.style.width = img_size.value + 'px';
                        set_picture_area.style.alignItems = "center";
                        set_picture_area.appendChild(pre_viewer.firstChild)
                        set_picture.style.display = "none";
                        if (set_picture_area.childNodes.length !== 3){
                            set_picture_area.firstChild.style.display = "inline";
                        }
                    }

                    new_picture_cancel.onclick = function (){
                        pre_viewer.removeChild(pre_viewer.firstChild);
                        set_picture.style.display = "none";
                    }
                }

                reset_picture_area_btn.onclick = function (){
                    let reset_picture_area = event.target.parentElement;
                    let reset_picture_ul = document.createElement('ul');
                    if(reset_elem_selector.childNodes.length !== 0){
                        reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                    }
                    for (let i = 3; i < reset_picture_area.childNodes.length; i++) {
                        let reset_picture_li = document.createElement('li');
                        reset_picture_li.id = i;
                        reset_picture_li.textContent = "編輯第" + (i-2) + "張圖片";
                        reset_picture_ul.appendChild(reset_picture_li);
                        reset_elem_selector.appendChild(reset_picture_ul);

                        reset_picture_li.onclick = function (){
                            let reset_picture = reset_picture_area.childNodes[event.target.id];
                            set_picture.style.display = "flex";
                            set_picture.style.flexDirection = "column";
                            delete_picture.style.display = "inline";
                            picture_onload.onchange = function(){
                                let reader = new FileReader();
                                let reset_img = document.createElement('img');

                                reader.onload = function (e){                               
                                    reset_img.setAttribute("src", e.target.result)
                                }
                                reader.readAsDataURL(this.files[0]);

                                pre_view_btn.onclick = function (){
                                    reset_img.style.width = 300 + 'px';
                                    pre_viewer.appendChild(reset_img);
                                }
                            }

                            new_picture_sent.onclick = function (){
                                pre_viewer.firstChild.style.width = img_size.value + 'px';
                                reset_picture_area.replaceChild(pre_viewer.firstElementChild,reset_picture);
                                set_picture.style.display = "none";
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);
                            }

                            delete_picture.onclick = function (){
                                reset_picture_area.removeChild(reset_picture);
                                set_picture.style.display = "none";
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);
                                if (reset_picture_area.childNodes.length == 3){
                                    reset_picture_area.firstChild.style.display = "none";
                                }
                            }

                            new_picture_cancel.onclick = function (){
                                pre_viewer.removeChild(pre_viewer.firstChild);
                                set_picture.style.display = "none";
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);  
                            }
                        }
                        
                    }
                }
            }
        
            function create_video_area(dropX ,target_block){
                let set_video = document.getElementById('set_video');
                let new_video_sent = document.getElementById("new_video_sent");
                let new_video_cancel = document.getElementById("new_video_cancel");
                let video_onload = document.getElementById("video_onload");
                let video_size = document.getElementById("video_size");
                let video_pre_view_btn = document.getElementById("video_pre_view_btn");
                let video_pre_viewer = document.getElementById("video_pre_viewer");
                let delete_video = document.getElementById("delete_video");
                let video_area = document.createElement('div');
                let delete_video_area_btn = document.createElement('input');
                let set_video_area_btn = document.createElement('input');
                let reset_video_area_btn = document.createElement('input');
                let set_div_btn = document.createElement('input');
                video_area.className= "elem_area";
                video_area.draggable="true"
                delete_video_area_btn.type = 'button';
                delete_video_area_btn.value = "刪除";
                delete_video_area_btn.classList = "delete_btn";
                set_video_area_btn.type = 'button';
                set_video_area_btn.value = "新增影片";
                set_video_area_btn.classList = "set_btn";
                reset_video_area_btn.type = 'button';
                reset_video_area_btn.value = "編輯影片";
                reset_video_area_btn.classList = "reset_btn";
                set_div_btn.type = 'button';
                set_div_btn.value = "編輯影片區塊";
                set_div_btn.classList = "set_div_btn";
                video_area.appendChild(reset_video_area_btn);
                video_area.appendChild(delete_video_area_btn);
                video_area.appendChild(set_video_area_btn);
                video_area.appendChild(set_div_btn);

                reset_video_area_btn.style.display = "none";

                set_div_btn.onclick = function (){
                    let div = event.target.parentElement;
                    let new_div = div.cloneNode();
                    set_div.style.display = "flex";
                    set_div.style.flexDirection = "column";
                    div_preview.appendChild(new_div)
                    div_preview_btn.onclick = function (){
                        new_div.style.width = 250 + 'px';
                        new_div.style.backgroundColor = background_color.value;
                        new_div.style.height = 250 + 'px';
                        new_div.style.borderColor = border_color.value;
                        new_div.style.borderStyle = border_style.value;
                        new_div.style.borderWidth = border_width.value + 'px';
                        new_div.style.borderRadius = border_radius.value +  'px';    
                    }

                    div_sent.onclick = function (){
                        div.style.minWidth = div_width.value + '%';
                        div.style.backgroundColor = background_color.value;
                        div.style.minHeight = div_height.value + 'px';
                        div.style.borderColor = border_color.value;
                        div.style.borderStyle = border_style.value;
                        div.style.borderWidth = border_width.value + 'px';
                        div.style.borderRadius = border_radius.value + 'px';

                        div.style.flexDirection = block_flexDirection.value;
                        if (block_flexDirection.value == "row") {
                            div.style.alignContent = sort_vertucally.value;
                            div.style.justifyContent = sort_horizontally.value;
                        }
                        else if (block_flexDirection.value == "column"){
                            div.style.alignItems = sort_horizontally.value;
                            div.style.justifyContent = sort_vertucally.value;
                        }
                        div.style.margin = block_margin.value + 'px';

                        set_div.style.display = "none";
                        div_preview.removeChild(div_preview.firstChild);
                    }
                }

                for (let i = 0; i < target_block.childNodes.length; i++) {
                    if (target_block.childNodes.length == 1){
                        target_block.appendChild(video_area);
                        break;
                    }
                    if (dropX < target_block.childNodes[i].offsetLeft){
                        target_block.insertBefore(video_area,target_block.childNodes[i]);
                        break;
                    }
                    if (dropX > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                        target_block.appendChild(video_area);
                        break;
                    }
                }

                video_area.ondragend = function (){
                    let x = event.pageX
                    for (let i = 0; i < target_block.childNodes.length; i++) {
                        if (x < target_block.childNodes[i].offsetLeft){
                            target_block.insertBefore(event.target,target_block.childNodes[i]);
                            break;
                        }
                        if (x > target_block.childNodes[i].offsetLeft && target_block.childNodes[i] === target_block.lastChild){
                            target_block.appendChild(event.target);
                            break;
                        }
                    }
                    event.stopPropagation()
                }

                delete_video_area_btn.onclick = function (){
                    target_block.removeChild(event.target.parentElement);
                    event.stopPropagation()
                }

                set_video_area_btn.onclick = function (){
                    let set_video_area = event.target.parentElement;
                    set_video.style.display = "flex";
                    set_video.style.flexDirection = "column";
                    delete_video.style.display = "none";
                    video_onload.onchange = function(){
                        let reader = new FileReader();
                        let video = document.createElement('video');
                        video.controls = true;
                        reader.onload = function (e){                               
                            video.setAttribute("src", e.target.result)
                        }
                        reader.readAsDataURL(this.files[0]);

                        video_pre_view_btn.onclick = function (){
                            video.style.width = 300 + 'px';
                            video_pre_viewer.appendChild(video)
                        }
                    }
                    
                    new_video_sent.onclick = function (){
                        video_pre_viewer.firstChild.style.width = video_size.value + 'px';
                        set_video_area.style.alignItems = "center";
                        set_video_area.appendChild(video_pre_viewer.firstChild)
                        set_video.style.display = "none";
                        if (set_video_area.childNodes.length !==3){
                            reset_video_area_btn.style.display = "inline";
                        }
                    }

                    new_video_cancel.onclick = function (){
                        video_pre_viewer.removeChild(video_pre_viewer.firstChild);
                        set_video.style.display = "none";
                    }

                    event.stopPropagation()
                }

                reset_video_area_btn.onclick = function(){
                    let reset_video_area = event.target.parentElement;
                    let reset_video_ul = document.createElement('ul');
                    if(reset_elem_selector.childNodes.length !== 0){
                        reset_elem_selector.removeChild(reset_elem_selector.firstChild)
                    }
                    for (let i = 3; i < reset_video_area.childNodes.length; i++) {
                        let reset_video_li = document.createElement('li');
                        reset_video_li.id = i;
                        reset_video_li.textContent = "編輯第"+(i-2)+"部影片"
                        reset_video_ul.appendChild(reset_video_li);
                        reset_elem_selector.appendChild(reset_video_ul);

                        reset_video_li.onclick = function (){
                            let reset_video = reset_video_area.childNodes[event.target.id];
                            set_video.style.display = "flex";
                            set_video.style.flexDirection = "column";
                            delete_video.style.display = "inline";
                            video_onload.onchange = function(){
                                let reader = new FileReader();
                                let video = document.createElement('video');
                                video.controls = true;
                                reader.onload = function (e){                               
                                    video.setAttribute("src", e.target.result)
                                }
                                reader.readAsDataURL(this.files[0]);

                                video_pre_view_btn.onclick = function (){
                                    video.style.width = 300 + 'px';
                                    video_pre_viewer.appendChild(video)
                                }
                            }

                            new_video_sent.onclick = function (){
                                video_pre_viewer.firstChild.style.width = video_size.value + 'px';
                                reset_video_area.replaceChild(video_pre_viewer.firstChild,reset_video);
                                set_video.style.display = "none";
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);
                            }

                            delete_video.onclick = function (){
                                reset_video_area.removeChild(reset_video);
                                set_video.style.display = "none";
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);
                                if (reset_video_area.childNodes.length ===3){
                                    reset_video_area_btn.style.display = "none";
                                }

                            }

                            new_video_cancel.onclick = function (){
                                video_pre_viewer.removeChild(video_pre_viewer.firstChild);
                                set_video.style.display = "none";
                                reset_elem_selector.removeChild(reset_elem_selector.firstChild);
                            }

                        }
                    }

                    event.stopPropagation()
                }
                
            }
        
        </script>
</html>